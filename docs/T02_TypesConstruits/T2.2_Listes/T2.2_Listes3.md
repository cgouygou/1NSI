# T2.2 Compléments sur les listes

## Copie de listes

!!! danger "Vu en classe : une copie un peu trop parfaite"
    Observez le code ci-dessous, réalisé sans trucage.
    ```python
    >>> listA = [1, 2, 3]
    >>> listB = listA
    >>> listA.append(7)
    >>> listB
    [1, 2, 3, 7]
    >>> listB.append(8)
    >>> listA
    [1, 2, 3, 7, 8]
    ```


Tout se passe comme si les listes  ```listA``` et```listB``` étaient devenus des clones «synchronisés» depuis l'affectation ```listB = listA```.

!!! aide "Analyse grâce à PythonTutor"
    <iframe width="800" height="300" frameborder="0" src="https://pythontutor.com/iframe-embed.html#code=listA%20%3D%20%5B1,%202,%203%5D%0AlistB%20%3D%20listA%0AlistA.append%287%29%0AlistB.append%288%29%0A&codeDivHeight=400&codeDivWidth=350&cumulative=false&curInstr=0&heapPrimitives=nevernest&origin=opt-frontend.js&py=3&rawInputLstJSON=%5B%5D&textReferences=false"> </iframe>



L'illustration de PythonTutor nous donne la clé de l'énigme :
![image](../images/tutor_liste.png){: .center width=30%}


```listA``` et```listB``` sont en fait **un seul et même objet**.

Comment en avoir le cœur net ? En observant leur adresse-mémoire, disponible grâce à la fonction ```id``` :

```python
>>> id(listA)
140485841327616
>>> id(listB)
140485841327616
```

Ceci met en évidence que la métaphore du tiroir dont on se sert pour expliquer ce qu'est une variable est malheureusement inexacte. Une variable est une référence vers une adresse-mémoire. Si deux variables font référence à la même adresse-mémoire, alors elles sont totalement identiques:  toute modification de l'une entraîne une modification de l'autre.  


### Mais alors, comment copier le contenu d'une liste vers une autre sans créer un clone ?

!!! note "Deux façons (entre autres) de créer une vraie copie d'une liste"
    ```python
    >>> listA = [3, 4, 5]
    >>> listB = listA.copy()
    >>> listC = list(listA)
    ```

{{ initexo(0) }}

!!! example "{{ exercice() }}"
    === "Énoncé"
        Contrôler les adresses mémoires avec la fonction `id` pour prouver que les exemples précédents produisent bien des objets différents.
    === "Correction"
        {{ correction(False,
        "
        ```python
        >>> listA = [3, 4, 5]
        >>> listB = list(listA)
        >>> listA.append(9)
        >>> listB
        [3, 4, 5]
        >>> id(listA)
        140157471522368
        >>> id(listB)
        140157465797184
        ```
        "
        ) }}


## Listes en compréhension


